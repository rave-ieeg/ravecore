<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Run a built-in 'YAEL' imaging processing workflow — cmd_run_yael_preprocess • ravecore</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Run a built-in 'YAEL' imaging processing workflow — cmd_run_yael_preprocess"><meta name="description" content="Image processing pipeline doi:10.1523/ENEURO.0328-23.2023
,
allowing cross-modality image registration, T1-weighted MRI normalization
to template brain, creating subject-level brain atlas from inverse
normalization."><meta property="og:description" content="Image processing pipeline doi:10.1523/ENEURO.0328-23.2023
,
allowing cross-modality image registration, T1-weighted MRI normalization
to template brain, creating subject-level brain atlas from inverse
normalization."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ravecore</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0.9003</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/rave-ieeg/ravecore/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Run a built-in 'YAEL' imaging processing workflow</h1>
      <small class="dont-index">Source: <a href="https://github.com/rave-ieeg/ravecore/blob/main/R/workflow-yael_preprocess.R" class="external-link"><code>R/workflow-yael_preprocess.R</code></a></small>
      <div class="d-none name"><code>cmd_run_yael_preprocess.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Image processing pipeline <a href="https://doi.org/10.1523/ENEURO.0328-23.2023" class="external-link">doi:10.1523/ENEURO.0328-23.2023</a>
,
allowing cross-modality image registration, T1-weighted MRI normalization
to template brain, creating subject-level brain atlas from inverse
normalization.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">yael_preprocess</span><span class="op">(</span></span>
<span>  <span class="va">subject</span>,</span>
<span>  t1w_path <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ct_path <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  t2w_path <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  fgatir_path <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  preopct_path <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  flair_path <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  t1w_contrast_path <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  register_policy <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"auto"</span>, <span class="st">"all"</span><span class="op">)</span>,</span>
<span>  register_reversed <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  normalize_template <span class="op">=</span> <span class="st">"mni_icbm152_nlin_asym_09b"</span>,</span>
<span>  normalize_policy <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"auto"</span>, <span class="st">"all"</span><span class="op">)</span>,</span>
<span>  normalize_images <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"T1w"</span>, <span class="st">"T2w"</span>, <span class="st">"T1wContrast"</span>, <span class="st">"fGATIR"</span>, <span class="st">"preopCT"</span><span class="op">)</span>,</span>
<span>  normalize_back <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">normalize_template</span><span class="op">)</span> <span class="op">&gt;=</span> <span class="fl">1</span>, <span class="va">normalize_template</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, <span class="cn">NA</span><span class="op">)</span>,</span>
<span>  atlases <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  add_surfaces <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">cmd_run_yael_preprocess</span><span class="op">(</span></span>
<span>  <span class="va">subject</span>,</span>
<span>  t1w_path <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ct_path <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  t2w_path <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  fgatir_path <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  preopct_path <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  flair_path <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  t1w_contrast_path <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  register_reversed <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  normalize_template <span class="op">=</span> <span class="st">"mni_icbm152_nlin_asym_09b"</span>,</span>
<span>  normalize_images <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"T1w"</span>, <span class="st">"T2w"</span>, <span class="st">"T1wContrast"</span>, <span class="st">"fGATIR"</span>, <span class="st">"preopCT"</span><span class="op">)</span>,</span>
<span>  run_recon_all <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  dry_run <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-subject">subject<a class="anchor" aria-label="anchor" href="#arg-subject"></a></dt>
<dd><p>subject ID</p></dd>


<dt id="arg-t-w-path">t1w_path<a class="anchor" aria-label="anchor" href="#arg-t-w-path"></a></dt>
<dd><p>path to 'T1'-weighted preoperative 'MRI', used as underlay
and base image. If you want to have 'ACPC' aligned scanner coordinate
system. Please align the image before feeding into this function. All images
must contain skulls (do not strip skulls)</p></dd>


<dt id="arg-ct-path-t-w-path-fgatir-path-preopct-path-flair-path-t-w-contrast-path">ct_path, t2w_path, fgatir_path, preopct_path, flair_path, t1w_contrast_path<a class="anchor" aria-label="anchor" href="#arg-ct-path-t-w-path-fgatir-path-preopct-path-flair-path-t-w-contrast-path"></a></dt>
<dd><p>additional optional images to be aligned to the underlay; the registration
will be symmetric and the rigid-body transforms will be stored.</p></dd>


<dt id="arg-register-policy">register_policy<a class="anchor" aria-label="anchor" href="#arg-register-policy"></a></dt>
<dd><p>whether to skip already registered images;
default is true (<code>'auto'</code>); set to <code>'all'</code> to ignore existing
registrations and force calculation</p></dd>


<dt id="arg-register-reversed">register_reversed<a class="anchor" aria-label="anchor" href="#arg-register-reversed"></a></dt>
<dd><p>whether to swap the moving images and the
fixing image; default is false</p></dd>


<dt id="arg-normalize-template">normalize_template<a class="anchor" aria-label="anchor" href="#arg-normalize-template"></a></dt>
<dd><p>template to normalize to: default is
<code>'mni_icbm152_nlin_asym_09b'</code> ('MNI152b', 0.5 mm resolution); when
the computer memory is below 12 gigabytes, the template will automatically
switch to <code>'mni_icbm152_nlin_asym_09a'</code> (known as 'MNI152a', 1 mm
voxel resolution). Other choices are <code>'mni_icbm152_nlin_asym_09c'</code>
and <code>'fsaverage'</code> (or known as 'MNI305')</p></dd>


<dt id="arg-normalize-policy">normalize_policy<a class="anchor" aria-label="anchor" href="#arg-normalize-policy"></a></dt>
<dd><p>whether to skip existing normalization, if
calculated; default is <code>'auto'</code> (yes); set to <code>'all'</code> to ignore</p></dd>


<dt id="arg-normalize-images">normalize_images<a class="anchor" aria-label="anchor" href="#arg-normalize-images"></a></dt>
<dd><p>images used for normalization; default is to
include common images before the implantation (if available)</p></dd>


<dt id="arg-normalize-back">normalize_back<a class="anchor" aria-label="anchor" href="#arg-normalize-back"></a></dt>
<dd><p>length of one (select from <code>normalize_template</code>),
which template is to be used to generate native brain mask and transform
matrices</p></dd>


<dt id="arg-atlases">atlases<a class="anchor" aria-label="anchor" href="#arg-atlases"></a></dt>
<dd><p>a named list: the names must be template names from
<code>normalize_template</code> and the values must be directories of atlases of
the corresponding templates (see 'Examples').</p></dd>


<dt id="arg-add-surfaces">add_surfaces<a class="anchor" aria-label="anchor" href="#arg-add-surfaces"></a></dt>
<dd><p>whether to add surfaces for the subject; default is
<code>FALSE</code>. The surfaces are created by reversing the normalization from
template brain, hence the results will not be accurate. Enable this option
only if cortical surface estimation is not critical (and 'FreeSurfer'
reconstructions are inaccessible)</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>whether to print out the information; default is <code>TRUE</code></p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>reserved for legacy code and deprecated arguments</p></dd>


<dt id="arg-run-recon-all">run_recon_all<a class="anchor" aria-label="anchor" href="#arg-run-recon-all"></a></dt>
<dd><p>whether to run 'FreeSurfer'; default is true</p></dd>


<dt id="arg-dry-run">dry_run<a class="anchor" aria-label="anchor" href="#arg-dry-run"></a></dt>
<dd><p>whether to dry-run</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Nothing, a subject imaging folder will be created under 'RAVE'
raw folder. It will take a while to run the workflow.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># For T1 normalization only; add ct_path to include coregistration</span></span></span>
<span class="r-in"><span><span class="fu">cmd_run_yael_preprocess</span><span class="op">(</span></span></span>
<span class="r-in"><span>  subject <span class="op">=</span> <span class="st">"pt01"</span>,</span></span>
<span class="r-in"><span>  t1w_path <span class="op">=</span> <span class="st">"/path/to/T1w.nii.gz"</span>,</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># normalize T1 to MNI152</span></span></span>
<span class="r-in"><span>  normalize_template <span class="op">=</span> <span class="st">'mni_icbm152_nlin_asym_09b'</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Zhengjia Wang, Xiang Zhang, John Magnotti, Michael Beauchamp.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

